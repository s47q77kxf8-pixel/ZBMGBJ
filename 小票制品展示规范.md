# 小票制品展示规范

本文档约定美工给单主（客户）的报价表上，**制品与赠品**的展示规则。目标：信息一目了然，每行满足「单价 × 数量 = 小计」时可自证。

---

## 一、总则

### 1.1 总览行（每个制品第一行）

- **数量、小计（制品总价）始终显示**。
- **单价列**：
  - 若 **单价 × 数量 = 小计** 成立 → 显示单价；
  - 否则（有同模、工艺、配件等混合价）→ 显示 `—`，不展示单价数字。

### 1.2 明细行

- 凡出现「单价」数字的行，必须满足 **单价 × 数量 = 小计**。
- **例外**：config（递增/配件）制品的**树形明细行**（└ 基础配置、└ 配件）仅显示单价，用于说明组成，不显示数量和小计。
- 统一用语：
  - **全价制品**：按全价计费的部分（无同模时数量=件数，有同模时数量=1）。
  - **同模制品（0.5x）**：按同模系数计费的部分（数量=件数−1）。

### 1.3 工艺行

- **分组**：按「每层单价」分组；每层单价相同 → 合并一行，层数累计。
- **单价**：每层单价（如 ¥10/层）。
- **数量**：计费量 =（累计层数）×（件数），如 5层×3件=15。
- **小计**：单价 × 数量。
- **名称示例**：`工艺（白墨3层、逆向2层）`、`工艺（UV1层）`。

### 1.4 单/双面（double 制品）

- **总览行**：制品名后标明 `（单面）` 或 `（双面）`，如 `拍立得（双面）`。
- **明细行**：不再在「全价制品」后重复写（单面/双面），只写 `全价制品`。

---

## 二、三类计价方式展示规则

### 2.1 fixed（固定价）

| 情形           | 总览行                         | 明细                             |
|----------------|--------------------------------|----------------------------------|
| 无同模 + 无工艺 | 1 行：制品名 单价 数量 小计    | 无                               |
| 无同模 + 有工艺 | `—` 数量 小计                  | 全价制品 + 工艺                   |
| 有同模         | `—` 数量 小计                  | 全价制品 + 同模制品 + 工艺（若有） |

**示例（无同模 + 无工艺）**
```
背卡                 ¥50.00   3   ¥150.00
```

**示例（无同模 + 有工艺）**
```
背卡                 —      3件   ¥345.00
全价制品            ¥50.00  3     ¥150.00
工艺（白墨3层）       ¥10.00  9     ¥90.00
工艺（UV1层）         ¥15.00  3     ¥45.00
```

**示例（有同模）**
```
背卡                 —      3件   ¥100.00
全价制品            ¥50.00  1     ¥50.00
同模制品（0.5x）      ¥25.00  2     ¥50.00
```

---

### 2.2 double（单双面）

| 情形           | 总览行                               | 明细                                        |
|----------------|--------------------------------------|---------------------------------------------|
| 无同模 + 无工艺 | 1 行：制品名（单/双面） 单价 数量 小计 | 无                                          |
| 无同模 + 有工艺 | `—` 数量 小计                        | 全价制品（不带单/双面）+ 工艺                 |
| 有同模         | `—` 数量 小计                        | 全价制品（不带单/双面）+ 同模制品 + 工艺（若有） |

**示例（无同模 + 无工艺）**
```
拍立得（双面）        ¥120.00  3   ¥360.00
```

**示例（无同模 + 有工艺）**
```
拍立得（双面）        —      3件   ¥555.00
全价制品              ¥120.00 3     ¥360.00
工艺（白墨3层、逆向2层） ¥10.00  15    ¥150.00
工艺（UV1层）          ¥15.00  3     ¥45.00
```

**示例（有同模）**
```
拍立得（双面）        —      3件   ¥240.00
全价制品              ¥120.00 1     ¥120.00
同模制品（0.5x）       ¥60.00  2     ¥120.00
```

---

### 2.3 config（递增/配件）

- 配件数量语义：**每件都有**（如每件 +2 个底座、+2 个插件）。
- 配件明细用 **树形**：`└ 基础配置（…）`、`└ 2个 底座`、`└ 2个 插件`；树形行**仅显示单价**（用于说明组成），不显示数量和小计。
- 配件行单价：**每件该配件合计价**（如 底座 ¥20/个×2=¥40/件）。

| 情形           | 总览行                    | 明细                                              |
|----------------|---------------------------|---------------------------------------------------|
| 无同模 + 无工艺 | 1 行：制品名 成品单价 数量 小计 | 全价制品 + 树形：└ 基础配置、└ 2个 底座、└ 2个 插件 |
| 无同模 + 有工艺 | `—` 数量 小计             | 全价制品 + 树形（同上）+ 工艺                      |
| 有同模         | `—` 数量 小计             | 全价制品 + 树形（同上）+ 同模制品 + 工艺（若有）     |

**示例（无同模 + 无工艺）**
```
立牌                 ¥230.00  3   ¥690.00
全价制品            ¥230.00  3     ¥690.00
 └ 基础配置（1插+1底座） ¥110.00
 └ 2个 底座            ¥40.00
 └ 2个 插件            ¥80.00
```

**示例（无同模 + 有工艺）**
```
立牌                 —      3件   ¥885.00
全价制品            ¥230.00  3     ¥690.00
 └ 基础配置（1插+1底座） ¥110.00
 └ 2个 底座            ¥40.00
 └ 2个 插件            ¥80.00
工艺（白墨3层、逆向2层）  ¥10.00  15    ¥150.00
工艺（UV1层）            ¥15.00  3     ¥45.00
```

**示例（有同模 + 有工艺）**
```
立牌                 —      3件   ¥655.00
全价制品            ¥230.00  1     ¥230.00
 └ 基础配置（1插+1底座） ¥110.00
 └ 2个 底座            ¥40.00
 └ 2个 插件            ¥80.00
同模制品（0.5x）        ¥115.00  2     ¥230.00
工艺（白墨3层、逆向2层）  ¥10.00  15    ¥150.00
工艺（UV1层）            ¥15.00  3     ¥45.00
```

---

## 三、收敛规则（何时只 1 行、何时拆明细）

- **fixed / double**：若仅有「全价制品」一行且无工艺、无同模 → **合并到总览行，只展示 1 行**。
- **config**：即使无同模、无工艺，总览行展示成品单价，**下面必须展示「全价制品」行 + 树形明细**（基础配置 + 配件），便于客户理解组成。

---

## 四、赠品

- 总览行：`¥0.00` + 划线原价（沿用现有逻辑）。
- 明细规则与制品一致（含工艺、配置等），避免客户误解。

---

## 五、汇总表

| 类型   | 情形           | 总览行                         | 明细                                           |
|--------|----------------|--------------------------------|------------------------------------------------|
| fixed  | 无同模无工艺   | 1 行合并                       | 无                                             |
| fixed  | 无同模有工艺   | `—` 数量 小计                  | 全价制品 + 工艺                                 |
| fixed  | 有同模         | `—` 数量 小计                  | 全价制品 + 同模制品 + 工艺（若有）               |
| double | 无同模无工艺   | 1 行合并，制品名（单/双面）     | 无                                             |
| double | 无同模有工艺   | `—` 数量 小计                  | 全价制品 + 工艺（全价制品后不写单/双面）         |
| double | 有同模         | `—` 数量 小计                  | 全价制品 + 同模制品 + 工艺（若有）；全价制品不写单/双面 |
| config | 无同模无工艺   | 1 行合并，成品单价             | 全价制品 + 树形：└ 基础配置、└ 2个 底座、└ 2个 插件 |
| config | 无同模有工艺   | `—` 数量 小计                  | 全价制品 + 树形（同上）+ 工艺                    |
| config | 有同模         | `—` 数量 小计                  | 全价制品 + 树形（同上）+ 同模制品 + 工艺（若有）   |

---

## 六、版本与修订

- 初始版本：根据需求与讨论整理。
- 后续若调整展示口径，在此文档中增补修订说明即可。
